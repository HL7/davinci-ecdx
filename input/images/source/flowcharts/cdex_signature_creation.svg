<svg height="1327.5812606811523" version="1.1" width="991.3125" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="overflow: hidden; position: relative; left: -0.5px; top: -0.515625px;" viewBox="0 0 991.3125 1327.5812606811523" preserveAspectRatio="xMidYMid meet"><desc style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">Created with RaphaÃ«l 2.2.0</desc><defs style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><marker id="raphael-marker-endblock33-obj01znh" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objfnlyt" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objmgt2g" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objxorzz" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objulji3" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objsk77q" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-obj11s9g" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objiv42q" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objgngbm" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-objpqiu6" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker><marker id="raphael-marker-endblock33-obj5tom2" markerHeight="3" markerWidth="3" orient="auto" refX="1.5" refY="1.5" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"><use xlink:href="#raphael-marker-block" transform="rotate(180 1.5 1.5) scale(0.6,0.6)" stroke-width="1.6667" fill="black" stroke="none" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);"></use></marker></defs><rect x="0" y="0" width="69.765625" height="38" rx="20" ry="20" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="st" transform="matrix(1,0,0,1,461.7734,23.3094)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="stt" class="flowchartt" transform="matrix(1,0,0,1,461.7734,23.3094)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="6">Start</tspan></text><rect x="0" y="0" width="865.984375" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="get_cert" transform="matrix(1,0,0,1,63.6641,134.5094)"></rect><rect x="10" y="0" width="845.984375" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" stroke-width="2" id="get_certi" font-family="'Andale Mono', monospace" transform="matrix(1,0,0,1,63.6641,134.5094)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="20" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="get_certt" class="flowchartt" transform="matrix(1,0,0,1,63.6641,134.5094)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625">Obtain a digital certificate and keys from a third-party certificate authority (CA)</tspan></text><rect x="0" y="0" width="985.3125" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="prep_base64_Der" transform="matrix(1,0,0,1,4,245.9281)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="prep_base64_Dert" class="flowchartt" transform="matrix(1,0,0,1,4,245.9281)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625">Prepare base64 DER Certifcate - it is Cert PEM file wihout the footer and header and line returns</tspan></text><rect x="0" y="0" width="597.203125" height="57.41875076293945" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="jws_header" transform="matrix(1,0,0,1,198.0547,347.7469)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="28.709375381469727" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="jws_headert" class="flowchartt" transform="matrix(1,0,0,1,198.0547,347.7469)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="-3.7093772888183594">Create JWS header to Attach to Bundle</tspan><tspan dy="19.2" x="10" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">header = {"alg": "RS256","kty": "RS", "x5c": [base64 DER]}</tspan></text><rect x="0" y="0" width="567.34375" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="prep_bundle" transform="matrix(1,0,0,1,212.9844,478.3656)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="prep_bundlet" class="flowchartt" transform="matrix(1,0,0,1,212.9844,478.3656)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625">Remove the id and meta element from Bundle to be signed</tspan></text><rect x="0" y="0" width="666.859375" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="canon_bundle" transform="matrix(1,0,0,1,163.2266,589.7844)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="canon_bundlet" class="flowchartt" transform="matrix(1,0,0,1,163.2266,589.7844)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625"> Canonicalize Bundle using IETF JSON Canonicalization Scheme (JCS)</tspan></text><rect x="0" y="0" width="656.90625" height="38.484375" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="base64_url_bundle" transform="matrix(1,0,0,1,168.2031,701.0703)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.2421875" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="base64_url_bundlet" class="flowchartt" transform="matrix(1,0,0,1,168.2031,701.0703)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.7578125">base64_urlize the canonicalized bundle- this is the JWS payload.</tspan></text><rect x="0" y="0" width="646.953125" height="76.6187515258789" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="creat_sig" transform="matrix(1,0,0,1,173.1797,793.5547)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="38.30937576293945" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="creat_sigt" class="flowchartt" transform="matrix(1,0,0,1,173.1797,793.5547)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="-13.309377670288086">Create Signature using private key</tspan><tspan dy="19.2" x="10" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">and RS256 algorithm to get the JWS compact serialization format</tspan><tspan dy="19.2" x="10" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">using the header and paylaod as inputs</tspan></text><rect x="0" y="0" width="497.6875" height="57.41875076293945" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="detach" transform="matrix(1,0,0,1,247.8125,933.7734)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="28.709375381469727" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="detacht" class="flowchartt" transform="matrix(1,0,0,1,247.8125,933.7734)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="-3.7093772888183594">detached payload by removing the payload element</tspan><tspan dy="19.2" x="10" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);">from the JWS compact serialization format</tspan></text><rect x="0" y="0" width="338.453125" height="38.484375" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="base64_jws" transform="matrix(1,0,0,1,327.4297,1064.2594)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.2421875" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="base64_jwst" class="flowchartt" transform="matrix(1,0,0,1,327.4297,1064.2594)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.7578125">base64 the JWS (not base64_url!)</tspan></text><rect x="0" y="0" width="547.4375" height="38.21875" rx="0" ry="0" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="add_sig" transform="matrix(1,0,0,1,222.9375,1175.9438)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="add_sigt" class="flowchartt" transform="matrix(1,0,0,1,222.9375,1175.9438)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625">Append FHIR Signature element to the Bundle be signed</tspan></text><rect x="0" y="0" width="179.234375" height="38.21875" rx="20" ry="20" fill="none" stroke="#000000" style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" stroke-width="2" class="flowchart" id="e" transform="matrix(1,0,0,1,407.0391,1287.3625)"></rect><text style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); text-anchor: start; font-family: &quot;Andale Mono&quot;, monospace; font-size: 16px;" x="10" y="19.109375" text-anchor="start" font-family="'Andale Mono', monospace" font-size="16px" stroke="none" fill="#000000" id="et" class="flowchartt" transform="matrix(1,0,0,1,407.0391,1287.3625)" stroke-width="1"><tspan style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0);" dy="5.890625">End (Happy Path)</tspan></text><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,61.30937576293945C496.65625,61.30937576293945,496.65625,117.72904760037272,496.65625,131.50338154505857" stroke-width="2" marker-end="url(#raphael-marker-endblock33-obj01znh)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,172.7281265258789C496.65625,172.7281265258789,496.65625,229.14779836331218,496.65625,242.92213230799803" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objfnlyt)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,284.14687728881836C496.65625,284.14687728881836,496.65625,332.1366960542896,496.65625,344.74339649170344" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objmgt2g)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,405.16562843322754C496.65625,405.16562843322754,496.65625,461.5853002706608,496.65625,475.35963421534666" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objxorzz)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,516.584379196167C496.65625,516.584379196167,496.65625,573.0040510336003,496.65625,586.7783849782861" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objulji3)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,628.0031299591064C496.65625,628.0031299591064,496.65625,684.3204351628265,496.65625,698.0697772535784" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objsk77q)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,739.5546932220459C496.65625,739.5546932220459,496.65625,779.2087931632996,496.65625,790.5551323066466" stroke-width="2" marker-end="url(#raphael-marker-endblock33-obj11s9g)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,870.1734447479248C496.65625,870.1734447479248,496.65625,918.163263513396,496.65625,930.7699639508098" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objiv42q)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,991.192195892334C496.65625,991.192195892334,496.65625,1047.509501096054,496.65625,1061.258843186806" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objgngbm)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,1102.7437591552734C496.65625,1102.7437591552734,496.65625,1159.1634309927067,496.65625,1172.9377649373926" stroke-width="2" marker-end="url(#raphael-marker-endblock33-objpqiu6)" font-family="'Andale Mono', monospace"></path><path style="-webkit-tap-highlight-color: rgba(0, 0, 0, 0); font-family: &quot;Andale Mono&quot;, monospace;" fill="none" stroke="#000000" d="M496.65625,1214.162509918213C496.65625,1214.162509918213,496.65625,1270.5821817556462,496.65625,1284.356515700332" stroke-width="2" marker-end="url(#raphael-marker-endblock33-obj5tom2)" font-family="'Andale Mono', monospace"></path></svg>