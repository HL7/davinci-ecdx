resourceType: StructureDefinition
id: cdex-task-attachment-request
url: 'http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-task-attachment-request'
version: 0.2.0
name: CDexTaskAttachmentRequest
title: CDex Task Attachment Request Profile
status: active
description: |-
  This Task profile is a specialization of the [Da Vinci CDex Task Data Request](http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/hrex-task-data-request) It defines a request for attachments for Claims and Prior Authorization that is compatible with existing X12 277 and 278 transactions.  It adds the following additional constraints for CDEX:
  - A `Task.identifier` element representing the Tracking ID
  - A `Task.requester.reference.identifier` element representing the Payer ID
  - A `Task.input` element slice representing the Payer Endpoint URL for submitting attachment using the `$submit-attachment` operation.
  - A `Task.input` element slice representing the Date of Service for the  Claim or Prior authorization.
  - An extension on the `Task.input` element "code" and "query" slices representing line item numbers in the Claim or Prior Authorization.
  - A required `Task.Restriction.period` representing the due date for the attachments.
  - A contained Patient Resource representing required patient information associated 2022-06-09 01:53:53with the claim or prior-authorization.

fhirVersion: 4.0.1
kind: resource
abstract: false
type: Task
baseDefinition: 'http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-task-data-request'
derivation: constraint
differential:
  element:


    - id: Task.contained
      path: Task.contained
      definition: >-
        The contained patient profile represents the required patient data needed for attachments requests
      short: Contained Patient resource
      min: 1
      max: '1'
      type:
        - code: Patient
          profile:
            - 'http://hl7.org/fhir/us/davinci-hrex/StructureDefinition/hrex-patient-demographics'
      mustSupport: true

      #note this profiled is missing identifer slices for patient acct number


    - id: Task.identifier
      path: Task.identifier

      slicing:
        discriminator:
          - type: pattern
            path: $this
        rules: open
      mustSupport: true

    - id: Task.identifier.value
      path: Task.identifier.value
      min: 1
      max: '1'
      mustSupport: true

    - id: 'Task.identifier:tracking-id'
      path: Task.identifier
      sliceName: tracking-id
      short: Re-association tracking control number
      definition: A unique claim/prior authorization identifier (referred to as the “re-association tracking control numbers”)
      min: 1
      max: '1'
      patternIdentifier:
        type:         
          coding:
            - system: 'http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp'
              code: tracker-id
      mustSupport: true

    - id: Task.for
      path: Task.for

    - id: Task.for.reference
      path: Task.for.reference
      short: Contained Patient Reference
      definition: Reference to contained Patient for required patient data
      min: 1
      fixedString: '#patient'
      mustSupport: true      

    - id: Task.requester
      path: Task.requester

    - id: Task.requester.identifier
      path: Task.requester.identifier
      short: Payer ID
      definition: business identifier representing the Payer ID
      min: 1
      mustSupport: true

    - id: 'Task.input:query'
      path: Task.input
      sliceName: query
   
    - id: 'Task.input:query.extension:item-ids'
      path: Task.input.extension
      sliceName: item-ids
      short: Line item numbers
      definition: The line item numbers in the Claim or Prior Authorization
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - 'http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/item-ids'
      mustSupport: true

    - id: 'Task.input:code'
      path: Task.input
      sliceName: code

    - id: 'Task.input:code.extension:item-ids'
      path: Task.input.extension
      sliceName: item-ids
      short: Line item numbers
      definition: The line item numbers in the Claim or Prior Authorization the request applies to.
      min: 0
      max: '1'
      type:
        - code: Extension
          profile:
            - 'http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/item-ids'
      mustSupport: true

    - id: 'Task.input:payer-url'
      path: Task.input
      sliceName: payer-url
      short: Payer Url
      definition: The Payer Endpoint URL for submitting attachment using the `$submit-attachment` operation.
      max: '1'
      mustSupport: true

    - id: 'Task.input:payer-url.type'
      path: Task.input.type
      patternCodeableConcept:
        coding:
          - system: 'http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp'
            code: payer-url
      mustSupport: true

    - id: 'Task.input:payer-url.value[x]'
      path: 'Task.input.value[x]'
      short: Payer url value
      type:
        - code: url
      mustSupport: true

    - id: 'Task.input:service-date'
      path: Task.input
      sliceName: service-date
      short: Date of Service
      definition: The Date of Service for the Claim or Prior Authorization.
      max: '1'
      mustSupport: true

    - id: 'Task.input:service-date.type'
      path: Task.input.type
      patternCodeableConcept:
        coding:
          - system: 'http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp'
            code: service-date
      mustSupport: true

    - id: 'Task.input:service-date.value[x]'
      path: 'Task.input.value[x]'
      short: Purpose of use value
      type:
        - code: date
      mustSupport: true

