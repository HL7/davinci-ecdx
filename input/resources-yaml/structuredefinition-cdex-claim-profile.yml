resourceType: StructureDefinition
id: cdex-claim
url: 'http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-claim'
name: CDexClaimProfile
title: CDex Claim Profile
status: active
description: |-
  This Claim Profile is defined to be [contained](http://hl7.org/fhir/R4/references.html) within the CDex Task Attachment Request Profile or CDex Task Data Request Profile.  It is referenced when a reason for a clinical data request is communicated and the reason is a claim or prior-authorization (for example, an attachment request or a claims audit).  It represents a claim or prior-authorization and defines the following *mandatory* (min=1) information:

  - A fixed resource ID = "claim"
  - A claim/prior-auth ID (business identifier)
  - A use ("claim" or "preauthorization")
  - Supporting information:
    - a fixed entry = "1"
    - a fixed category = "patientEvent"
    - date or period of service
  - A fixed reference to the contained Patient resource = "#patient"
  - Insurance information:
      - a fixed sequence = "1"
      - a flag fixed to "true" to indicating that this Coverage is to be used for adjudication
      - a coverage referencing the Member Id (business identifier)

  In addition, these *mandatory* (min=1) elements are inherited from the FHIR Claim resource:
    - Resource status
    - Claim category
    - Resource creation date
    - Provider responsible for the claim
    - Claim priority



fhirVersion: 4.0.1
kind: resource
abstract: false
type: Claim
baseDefinition: 'http://hl7.org/fhir/StructureDefinition/Claim'
derivation: constraint
differential:
  element:


    - id: Claim.id
      path: Claim.id
      short: Resource ID Default Value
      min: 1
      max: '1'
      fixedString: claim  # referenced by Task.reasonReference.reference
      mustSupport: true      

    - id: Claim.identifier
      path: Claim.identifier
      short: Claim/Prior-Auth ID
      min: 1      
      slicing:
        discriminator:
          - type: pattern  # need identifier type for this to work
            path: $this 
        rules: open
      mustSupport: true

    - id: Claim.identifier.value
      path: Claim.identifier.value
      min: 1
      max: '1'
      mustSupport: true

    - id: 'Claim.identifier:claim-id'
      path: Claim.identifier
      sliceName: claim-id
      min: 1
      max: '1'
      patternIdentifier:   # need identifier type for slicing
        type:
          coding:
            - system: 'http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBIdentifierType'
              code: uc
      mustSupport: true

    - id: Claim.status
      path: Claim.status
      fixedCode: active
      mustSupport: true 

    - id: Claim.type
      path: Claim.type
      mustSupport: true     

    - id: Claim.use
      path: Claim.use
      short: claim | preauthorization
      definition: 'A code to indicate whether the nature of the request is: to request adjudication of products and services previously rendered; or requesting authorization and adjudication for provision in the future'
      binding:
        strength: required
        valueSet: 'http://hl7.org/fhir/us/davinci-cdex/ValueSet/cdex-claim-use'
      mustSupport: true
     

    - id: Claim.patient
      path: Claim.patient
      mustSupport: true

    - id: Claim.patient.reference
      path: Claim.patient.reference
      short: Contained Patient
      definition: A fixed reference to the contained Patient resource = '#patient'
      min: 1
      fixedString: '#patient'
      mustSupport: true

    - id: Claim.created
      path: Claim.created
      mustSupport: true

    - id: Claim.provider     # should be NPI supplied by Payer
      path: Claim.provider
      mustSupport: true 

    - id: Claim.provider.identifier
      path: Claim.provider.identifier
      short: provider ID
      definition: business identifier representing the provider ID   # should be NPI supplied by Payer
      min: 1
      mustSupport: true 

    - id: Claim.priority
      path: Claim.priority
      comment: '-'
      mustSupport: true 

    - id: Claim.supportingInfo
      path: Claim.supportingInfo
      min: 1
      slicing:
        discriminator:
          - type: value
            path: category
        rules: open
      mustSupport: true 

    - id: 'Claim.supportingInfo:PatientEvent'
      path: Claim.supportingInfo
      sliceName: PatientEvent
      short: Information about the dates of the event that are being requested.
      min: 1
      max: '1'
      mustSupport: true

    - id: Claim.supportingInfo:PatientEvent.sequence
      path: Claim.supportingInfo.sequence
      fixedPositiveInt: 1
      mustSupport: true

    - id: Claim.supportingInfo:PatientEvent.category
      path: Claim.supportingInfo.category
      patternCodeableConcept:
        coding:
          - system: 'http://hl7.org/fhir/us/davinci-pas/CodeSystem/PASSupportingInfoType'
            code: patientEvent
      mustSupport: true

    - id: 'Claim.supportingInfo:PatientEvent.timing[x]'
      path: Claim.supportingInfo.timing[x]
      min: 1 
      mustSupport: true


    - id: Claim.insurance
      path: Claim.insurance
      min: 1
      slicing:
        discriminator:
          - type: value
            path: sequence
        rules: open
      mustSupport: true 

    - id: 'Claim.insurance:PatientEvent'
      path: Claim.insurance
      sliceName: PatientEvent
      # short: 
      min: 1
      max: '1'
      mustSupport: true

    - id: Claim.insurance:PatientEvent.sequence
      path: Claim.insurance.sequence
      fixedPositiveInt: 1
      mustSupport: true

    - id: Claim.insurance:PatientEvent.focal
      path: Claim.insurance.focal
      fixedBoolean: true
      mustSupport: true

    - id: 'Claim.insurance:PatientEvent.coverage'
      path: Claim.insurance.coverage
      mustSupport: true 

    - id: Claim.insurance:PatientEvent.coverage.identifier
      path: Claim.insurance.coverage.identifier
      short: Unique Member Identifier
      definition: The unique member identifier for this patient.
      min: 1
      mustSupport: true


