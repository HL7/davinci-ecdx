
# steps to create/update dig signature examples
#
# 1. create unsigned Bundle or QuestionnaireResponse example source file with minified Narrative element(s) to prevent the publisher from adding its own.
# 1. for Documents Bundles use the autogenerated narrative instead to get it to verify. ( use only the -i parameter to keep the meta elements )
# 1. optionally create certificate using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Cert.ipynb
# 1. create signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Digsign_Bundle_or_QR.ipynb
#  -  remove elements from payload as defined by the signature canonical and publisher requirements (for example, meta profile elements)
# 1. save to YAML source
# 1. run sushi and publisher again with -ink parameters
# 1. verify signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Verify_digsign_Bundle_or_QR.ipynb

resourceType: QuestionnaireResponse
id: cdex-questionnaireresponse-example4
meta:
  extension:
  - url: http://hl7.org/fhir/StructureDefinition/instance-name
    valueString: CDex QuestionnaireResponse Example4
  - url: http://hl7.org/fhir/StructureDefinition/instance-description
    valueMarkdown: This Questionnaire Response example demonstrates the response to
      a CDEX Data Query or Attachments that uses a Questionnaire to request the data
      and an electronic *digital* Verification signature is required. It is adapted
      from the Da Vinci DTR IG. The digital signature is a JSON [FHIR Signature](http://hl7.org/fhir/R4/signatures.html)
      in the QuestionnaireResponse signature extension. This example is adapted from
      the Da Vinci DTR IG.
  profile:
  - http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-sdc-questionnaireresponse
questionnaire: http://example.org/cdex-questionnaire-example2
status: completed
subject:
  identifier:
    use: usual
    type:
      coding:
      - system: http://terminology.hl7.org/CodeSystem/v2-0203
        code: MB
        display: Member Number
      text: Member Number
    system: http://example.org/cdex/payer/member-ids
    value: Member123
  display: Amy Shaw
authored: '2022-06-17'
author:
  identifier:
    system: http://hl7.org/fhir/sid/us-npi
    value: '9941339100'
text:
  status: generated
  div: '<div xmlns="http://www.w3.org/1999/xhtml"><h1>Questionnaire Response Summary
    for Amy Shaw</h1><p><strong>Questionnaire: </strong><a href="http://example.org/cdex-questionnaire-example2">CDEX
    Questionnaire Example2</a></p><p><strong>Date Completed: </strong>June 17, 2022</p><p><strong>Patient:
    </strong>Amy Shaw (Member Number: Member123)</p><h2>Questions and Answers</h2><ol><li><strong>Relevant
    Patient Diagnoses (conditions that might be expected to improve with oxygen therapy):
    </strong>Examplitis</li><li><strong>Order Reason: </strong>Replacement</li></ol></div>'
item:
- linkId: '1'
  text: Relevant Patient Diagnoses (conditions that might be expected to improve with
    oxygen therapy)
  answer:
  - valueString: Examplitis
- linkId: '2'
  text: Order Reason
  answer:
  - valueCoding:
      system: http://example.org
      code: '4'
      display: Replacement
extension:
- url: http://hl7.org/fhir/StructureDefinition/questionnaireresponse-signature
  valueSignature:
    type:
    - system: urn:iso-astm:E1762-95:2013
      code: 1.2.840.10065.1.12.1.5
      display: Verification Signature
    when: '2020-10-23T04:54:56.048+00:00'
    who:
      identifier:
        system: http://hl7.org/fhir/sid/us-npi
        type:
          coding:
          - system: http://terminology.hl7.org/CodeSystem/v2-0203
            code: NPI
        value: '9941339100'
      display: John Hancock, MD
    onBehalfOf:
      identifier:
        system: http://hl7.org/fhir/sid/us-npi
        value: '1234567893'
    targetFormat: application/fhir+json;canonicalization=http://hl7.org/fhir/canonicalization/json#document
    sigFormat: application/jose
    data: ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNkltSm1ZbVV6WlRWak1EUTNNRFEwTkRVM05qVTBPREV4TXpreU9HUTFaakZsTkdVelpqSmxaV0lpTENKcmRIa2lPaUpTVXlJc0luTnBaMVFpT2lJeU1ESXdMVEV3TFRJelZEQTBPalUwT2pVMkxqQTBPQ3N3TURvd01DSXNJbk55UTIxeklqcGJleUpqYjIxdFNXUWlPbnNpWkdWell5STZJbFpsY21sbWFXTmhkR2x2YmlCVGFXZHVZWFIxY21VaUxDSnBaQ0k2SW5WeWJqcHZhV1E2TVM0eUxqZzBNQzR4TURBMk5TNHhMakV5TGpFdU5TSjlMQ0pqYjIxdFVYVmhiSE1pT2xzaVZtVnlhV1pwWTJGMGFXOXVJRzltSUcxbFpHbGpZV3dnY21WamIzSmtJR2x1ZEdWbmNtbDBlU0pkZlYwc0luUjVjQ0k2SWtwWFZDSXNJbmcxWXlJNld5Sk5TVWxHVm5wRFEwRTNLMmRCZDBsQ1FXZEpWVUp1TkROR05FOHhNVEI2Vms1SVVGVjBRbTV1V0dZek0wWlJkM2RFVVZsS1MyOWFTV2gyWTA1QlVVVk1RbEZCZDJkYVZYaERla0ZLUW1kT1ZrSkJXVlJCYkZaVVRWSk5kMFZSV1VSV1VWRkpSRUZ3UkZsWGVIQmFiVGw1WW0xc2FFMVNTWGRGUVZsRVZsRlJTRVJCYkZSWldGWjZXVmQ0Y0dSSE9IaElWRUZpUW1kT1ZrSkJiMDFHUlZZMFdWY3hkMkpIVldkVU0wcHVXVmMxY0dWdFJqQmhWemwxVFZKcmQwWjNXVVJXVVZGRVJFSkNTMkl5YUhWSlJXaG9ZbTFPZGxreWMzTkpSVEZGVFZOTmQwbFJXVXBMYjFwSmFIWmpUa0ZSYTBKR2FGSnhZVWRHZFZreU9XcGhNRUpzWlVkR2RHTkhlR3hNYlRsNVducEJaVVozTUhsT1ZFRXlUV3BWZVUxNlJYbE5lbXhoUm5jd2VVNTZRVEpOVkZWNVRYcEZlVTE2YkdGTlNVZFdUVkZ6ZDBOUldVUldVVkZIUlhkS1ZsVjZSVlJOUWtWSFFURlZSVU5CZDB0Uk1rWnpZVmRhZG1OdE5YQlpWRVZUVFVKQlIwRXhWVVZDZDNkS1ZUSkdNV015Um5OaFdGSjJUVkl3ZDBkM1dVUldVVkZMUkVKU1JtVkhSblJqUjNoc1NVVTVlVm95Um5WaFdIQm9aRWRzZG1KcVJWcE5RbU5IUVRGVlJVRjNkMUZUYlRsdlltbENTVmxYTldwaU1rNXlURU5DVGxKRVJXcE5RMFZIUTFOeFIxTkpZak5FVVVWS1FWSlpWV0Z0YUdoaWJVNTJXVEowUVZwWWFHaGlXRUp6V2xNMWRtTnRZM2RuWjBkcFRVRXdSME5UY1VkVFNXSXpSRkZGUWtGUlZVRkJORWxDYW5kQmQyZG5SMHRCYjBsQ1oxRkRZMWh0ZGxnMk1FZEJOVWNyUkd3MGFWSnVPVlJUTDNkVVJqRkdWRWc1VW0xeVVESTVSelpZVTA5MVZrUkZaMGRhZDFWVVNra3ZUMnRTVEZCcUswcFZTM2t2YTAxWk0xbHROREZyTTBwU2NqaE9ja28zVldOcVpqTlVaVEpaTUhwdFVrMW1SMHRQTWxnM2NEQXhTV1E0Y2tkb2JtSnpWR3RYYW5ONlkyTnJha3RQVkdzM1JUUklXRTgzV0ZGdFZuWlNXbUZRY21wdVZsWnplalpoU1ZWdGJWVjVRbVZ0VlhoelVGRjRjV3RrTnpkNlVrdGxNVW9yWmsxaWNHSlRibUZHTWxNMVNEbEpOVWx3VVhVelpYSlRhazUzZFc1MWJVcEJMelZ6VGtGVFRWVm1LMXB5U3pWb2RIZFFabXh2Ym14V1FUbElSVkJ2Tms0MWRFcHpRMDFGV1RWeGExcEJXRVExTlZCVlltWTRTWGh5WkRNcmRERnBXRTVCWjAxa1dGQndPVTVxWm0xcmVtRklUM05TTlVWTU56aHZWbVowUzBnNFdFMW5jemxNSzFoWWFHTnRjQ3RUZFZOaVZWUXJiR0ZSUm01TFdsbzJOakZGUWpoVlZsRkhVR2h6U0dOMVdYbzNUUzhyUjBRM2JHdHRialYzTjJjMmFYcFpNRFZFY3pGMFpIUm9NMmhDSzBVeFpUQldPR0ZzTUN0SVdYaFlkRzFNTWpoUFluSjFjbHAwTlZaUFZEWXpObUZDVjJWaGF6TnRNV3gwSzBwTWFWUlhkMk5KV0hWeWFVcDNXRU5STjFjeVQyaEpjbXhsUW01ME5WbFNaRVl2Vm5kclFXWTFRbkEwTUVSTGNsbFRka0pVTDNnelVHRnlZbU5CY3pWeWRXRTBUV2w2ZEhwM2VrMURRWGRGUVVGaFQwSnVSRU5DYlZSQlNrSm5UbFpJVWsxRlFXcEJRVTFCYzBkQk1WVmtSSGRSUlVGM1NVWTBSRUpuUW1kT1ZraFNSVVZYVkVKWVoyYzVNMlF6WTNWYVdHaG9ZbGhDYzFwVE5YWmpiV1ZuUjFGWlNsbEpXa2xCV1dJMVYzZFJSMjlCZDAxRGFtczFUa1JGZWsxNmEzaE5SRU5IUzFkb01HUklRbnBQYVRoMldsaG9hR0pZUW5OYVV6VjJZMjFqZGxwdGFIQmphVGxSWTIxR2FtUkhiREJoVnpsMVdsaEpkazFVU1hwTlFqQkhRVEZWWkVSblVWZENRbE12ZG1vMVkwSklRa1ZTV0ZwVloxSlBVMnBXT0dWVWFqaDFObnBCVGtKbmEzRm9hMmxIT1hjd1FrRlJjMFpCUVU5RFFWbEZRV1pIYURCbWRqYzJRazE1VW5CcGJpODJiVEpPYms5QmQxbE9LMWRaVGxjMFduZFJTMUJ2YUN0cFFrWnFaMkl2WjFoYUwzZ3paRzVIY1RKU1ZXNVNTRXg1WW1OMmNVOTNRemgwTkN0TU1sRmhaVzUwZWk5NlUweG1Ra2xwU0ZBcmRuUmhkVlp2TkZscGNsVkxTVVpQTlU1clJHSlFVbmRGV0RaYWNHOTBkMUpGTW5BeldWQlBjVzFNYWxWd2RYRmxla3RTWm5WNlptWkZVMGxIUTFkbU5tSkJXbTlJT0c5MmVYcHJjRlZQZUZReWJHTktUREpaVVdkNFlVVkZLeTlOVDBWRWVHSjVMMGMxZEU1c1NGZFZNWEp0TWpsRVdrUTJhVlJ1T0VaSVRVOWlORVJCWlV4ek4yUmxWVUpMWlVGNGJVTk9NWGN3TjBsaVNHWlVXQ3M0ZUc5NlFtczRiVFJ5VVdGU1NUSkdZV05IWTA0dlV6UlBhMmxwYW14b2ExbHVSR1JpWWpaYWIwbENPVGxCVFVjdk1IUk5aMWRuYURVMVJrTk1PWGN5ZVhWaVJrUnpVaXN4ZVZwWE5YYzJlSFpXZFdKR2IzRXlja3RKV1U0MlFsUk5WRE0wT1U0clMxbEdVbFJpSzNCWU1EUlJSa1pEY1ZneFQzbDFVVVZLYWtwd1dtRjFURWxXVTIxVllWWjZSRmRrWVZKdGREQnlhMHhFTmxJNE5YUm9XVXB3VG5oTmNqUnZRWEp6ZVRWcGJEVk1NRXBXVFVWWVJ6RXhRMmhGZUZKRFNqZFljMmhyZEV4cWFpdEJPR3hrVlZKeVRFaFNWMWh2ZEhnMmJVNVdjRE1yVFc5cFEyaDROMUJtYmtkMlExQmhVSFpyVEZGeGFXVTRaRGh5YXpCbGFrNHpJbDE5Li5rcUZ4VkxwV1VfMU40Yzg2TVJJYXlWQXFneF9JSFBfdk5iWlpGamN3cnRvVDV3ZnhWejQyd2NCZmVtQjlTWWRYaTdUR3BqN2ZzbVNWVEVlUk1qMm1rZ1o0ek95LUF3azFOX0pkSzNvZmFUeWphYkR5NTJyUERndFN6ZzMwdlBqaWJLTFFQVWxXN3doR01Xb2NORWVXNW1yRGdwUjR6UThGMFNJSjNvU2pkbFVoalZuZzRYRmxhZ2lKOHgtZldIQ0JZXzRWTmFZU2tUc0JFMlUxZURXWUgxR2NyVmF1ejh0MlBkOFJ2allkbXg5Z1JoM0x3dVZRNmJVTVpJZS14WDVLUmtVV19KbmJmdG8tM3ZZb2JOZ3gyUVk2enNvR0ZSbzFsWHlrUDZjRDhIS2VmUFRGT0pFNUFuT0U0NjB1SVdJU1lmU3kyMXBDaThaWmYxbFRuZ1ZCME5vZXZJYjd4OFctNldJSXhSX2N2X3JlVlNfcElGb3ZSVS1tTVNDa1Y2akhoX2NDWnMxUDhOSG5oajVPdlhVaHhqajkwWHlOd1BVclJlMDdMbllHSlRxbEtmVnRoMHNfMmtWRU83b20zVVQ4RTJaZHRQdkVpeFIwWkF3RW5Ra1Qxa1BEaXd6ZXotcHpNTTBQbGJ1NWFHQlV1SGZRTFpYVHpteU9pdU0tUG1wRw==
