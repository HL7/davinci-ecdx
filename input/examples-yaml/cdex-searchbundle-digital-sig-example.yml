
# steps to create/update dig signature examples
#
# 1. create unsigned Bundle or QuestionnaireResponse example source file with minified Narrative element(s) to prevent the publisher from adding its own.
# 1. for Documents Bundles use the autogenerated narrative instead to get it to verify. ( use only the -i parameter to keep the meta elements )
# 1. optionally create certificate using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Cert.ipynb
# 1. create signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Digsign_Bundle_or_QR.ipynb
#  -  remove elements from payload as defined by the signature canonical and publisher requirements (for example, meta profile elements)
# 1. save to YAML source
# 1. run sushi and publisher again with -ink parameters
# 1. verify signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Verify_digsign_Bundle_or_QR.ipynb

resourceType: Bundle
type: searchset
total: 1
link:
- relation: self
  url: http://hapi.fhir.org/baseR4/Condition?patient=06e1f0dd-5fbe-4480-9bb4-6b54ec02d31b
entry:
- fullUrl: http://hapi.fhir.org/baseR4/Condition/4ac41715-fcbd-421c-8796-9b2c9706dd3f
  resource:
    resourceType: Condition
    id: 4ac41715-fcbd-421c-8796-9b2c9706dd3f
    meta:
      versionId: '10'
      lastUpdated: '2020-04-28T20:28:00.008+00:00'
    text:
      status: generated
      div: '<div xmlns="http://www.w3.org/1999/xhtml"><a name="Condition_4ac41715-fcbd-421c-8796-9b2c9706dd3f">
        </a><p class="res-header-id"><b>Generated Narrative: Condition 4ac41715-fcbd-421c-8796-9b2c9706dd3f</b></p><a
        name="4ac41715-fcbd-421c-8796-9b2c9706dd3f"> </a><a name="hc4ac41715-fcbd-421c-8796-9b2c9706dd3f">
        </a><a name="4ac41715-fcbd-421c-8796-9b2c9706dd3f-en-US"> </a><div style="display:
        inline-block; background-color: #d9e0e7; padding: 6px; margin: 4px; border:
        1px solid #8da1b4; border-radius: 5px; line-height: 60%"><p style="margin-bottom:
        0px">version: 10; Last updated: 2020-04-28 20:28:00+0000; </p><p style="margin-bottom:
        0px">Information Source: #cabiJIK51sD2iz4N</p></div><p><b>clinicalStatus</b>:
        <span title="Codes:{http://terminology.hl7.org/CodeSystem/condition-clinical
        active}">Active</span></p><p><b>verificationStatus</b>: <span title="Codes:{http://terminology.hl7.org/CodeSystem/condition-ver-status
        confirmed}">Confirmed</span></p><p><b>category</b>: <span title="Codes:{http://terminology.hl7.org/CodeSystem/condition-category
        encounter-diagnosis}">Encounter Diagnosis</span></p><p><b>code</b>: <span
        title="Codes:{http://snomed.info/sct 122481008}">Hammer Toe</span></p><p><b>subject</b>:
        <a href="http://example.org/cdex/provider/fhir/Patient/06e1f0dd-5fbe-4480-9bb4-6b54ec02d31b">http://example.org/cdex/provider/fhir/Patient/06e1f0dd-5fbe-4480-9bb4-6b54ec02d31b</a></p><p><b>encounter</b>:
        <a href="http://example.org/cdex/provider/fhir/Encounter/5fe62cd5-bfcf-4d3b-a1e9-80d6f75d6f82">http://example.org/cdex/provider/fhir/Encounter/5fe62cd5-bfcf-4d3b-a1e9-80d6f75d6f82</a></p><p><b>onset</b>:
        2018-10-21 21:22:15-0700</p><p><b>recordedDate</b>: 2018-10-21 21:22:15-0700</p></div>'
    clinicalStatus:
      coding:
      - system: http://terminology.hl7.org/CodeSystem/condition-clinical
        code: active
    verificationStatus:
      coding:
      - system: http://terminology.hl7.org/CodeSystem/condition-ver-status
        code: confirmed
    category:
    - coding:
      - system: http://terminology.hl7.org/CodeSystem/condition-category
        code: encounter-diagnosis
        display: Encounter Diagnosis
    code:
      coding:
      - system: http://snomed.info/sct
        code: '122481008'
        display: Hammer toe (disorder)
      text: Hammer Toe
    subject:
      reference: http://example.org/cdex/provider/fhir/Patient/06e1f0dd-5fbe-4480-9bb4-6b54ec02d31b
    encounter:
      reference: http://example.org/cdex/provider/fhir/Encounter/5fe62cd5-bfcf-4d3b-a1e9-80d6f75d6f82
    onsetDateTime: '2018-10-21T21:22:15-07:00'
    recordedDate: '2018-10-21T21:22:15-07:00'
  search:
    mode: match
id: cdex-searchbundle-digital-sig-example
meta:
  extension:
  - url: http://hl7.org/fhir/StructureDefinition/instance-name
    valueString: CDEX SearchSet Bundle with Digital Signature Example
  - url: http://hl7.org/fhir/StructureDefinition/instance-description
    valueMarkdown: Digital signature example showing how it is used to sign a [search
      set Bundle ](direct-query.html#signatures).  The CDEX use case would be a response
      to a Direct Query where a digital signature was required.
  profile:
  - http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-signature-bundle
signature:
  type:
  - system: urn:iso-astm:E1762-95:2013
    code: 1.2.840.10065.1.12.1.5
    display: Verification Signature
  when: '2020-10-23T04:54:56.048+00:00'
  who:
    identifier:
      system: http://hl7.org/fhir/sid/us-npi
      type:
        coding:
        - system: http://terminology.hl7.org/CodeSystem/v2-0203
          code: NPI
      value: '1234567893'
    display: CDEX Example Organization
  targetFormat: application/fhir+json;canonicalization=http://hl7.org/fhir/canonicalization/json#document
  sigFormat: application/jose
  data: ZXlKaGJHY2lPaUpTVXpJMU5pSXNJbXRwWkNJNklqUmhZamN6WmpWbU5qbGlZMlF4TXpNMlpUaGpPVEJrWVROak4yRm1PRE5oTUdFd1kySXdZVEFpTENKcmRIa2lPaUpTVXlJc0luTnBaMVFpT2lJeU1ESXdMVEV3TFRJelZEQTBPalUwT2pVMkxqQTBPQ3N3TURvd01DSXNJbk55UTIxeklqcGJleUpqYjIxdFNXUWlPbnNpWkdWell5STZJbFpsY21sbWFXTmhkR2x2YmlCVGFXZHVZWFIxY21VaUxDSnBaQ0k2SW5WeWJqcHZhV1E2TVM0eUxqZzBNQzR4TURBMk5TNHhMakV5TGpFdU5TSjlMQ0pqYjIxdFVYVmhiSE1pT2xzaVZtVnlhV1pwWTJGMGFXOXVJRzltSUcxbFpHbGpZV3dnY21WamIzSmtJR2x1ZEdWbmNtbDBlU0pkZlYwc0luUjVjQ0k2SWtwWFZDSXNJbmcxWXlJNld5Sk5TVWxHWlZSRFEwRXJSMmRCZDBsQ1FXZEpWV1VyVW05YVprSlRkSEZMV0hWRGVIQlFNbU5qU2tVd1Yxb3hOSGRFVVZsS1MyOWFTV2gyWTA1QlVVVk1RbEZCZDJkaFdYaERla0ZLUW1kT1ZrSkJXVlJCYkZaVVRWSlpkMFpCV1VSV1VWRkpSRUV4VGxsWVRucFpWMDV2WkZoT2JHUklVbnBOVVRoM1JGRlpSRlpSVVVoRVFWcERZak5PTUdJeU5IaElWRUZpUW1kT1ZrSkJiMDFHUlZZMFdWY3hkMkpIVldkVU0wcHVXVmMxY0dWdFJqQmhWemwxVFZOSmQwbEJXVVJXVVZGRVJFSnNSRkpGVmxsSlJWWTBXVmN4ZDJKSFZXZFVNMHB1V1ZjMWNHVnRSakJoVnpsMVRWTnpkMHRSV1VwTGIxcEphSFpqVGtGUmEwSkdhSGhxWkZoT01HSXlNV3hqYVRGNldsaEtNbUZYVG14UlIxWTBXVmN4ZDJKSFZYVmlNMHB1VFVJMFdFUlVTVEZOUkdONVRrUkZNazFxYTNsTmJHOVlSRlJKTTAxRVkzaE9SRVV5VFdwcmVVMXNiM2RuWVZsNFEzcEJTa0puVGxaQ1FWbFVRV3hXVkUxU1dYZEdRVmxFVmxGUlNVUkJNVTVaV0U1NldWZE9iMlJZVG14a1NGSjZUVkU0ZDBSUldVUldVVkZJUkVGYVEySXpUakJpTWpSNFNGUkJZa0puVGxaQ1FXOU5Sa1ZXTkZsWE1YZGlSMVZuVkROS2JsbFhOWEJsYlVZd1lWYzVkVTFUU1hkSlFWbEVWbEZSUkVSQ2JFUlNSVlpaU1VWV05GbFhNWGRpUjFWblZETktibGxYTlhCbGJVWXdZVmM1ZFUxVGMzZExVVmxLUzI5YVNXaDJZMDVCVVd0Q1JtaDRhbVJZVGpCaU1qRnNZMmt4ZWxwWVNqSmhWMDVzVVVkV05GbFhNWGRpUjFWMVlqTktiazFKU1VKdmFrRk9RbWRyY1docmFVYzVkekJDUVZGRlJrRkJUME5CV1RoQlRVbEpRbWxuUzBOQldVVkJkVWN6YUcxVWJITTBWR3hLTW5CR1FWTk9XbGQ2V2tkc1JqQndTVmxLYkdOeWRrZEdjM0ZJVGxGMk5EZFNORzkwWTI5bmRGcDNjR1V5YVhCWWFVOUpNVlZMZFZnMmVtRldla1JZUW5wbVR6RkRUVWh0Y1hFMWVWSXhjSFV5YlRGTGRVRXZVVU54VmxOMmR6WjZhRGxEZVVkR2JWSnZiMlJIUmt4aVkydHdkbWRvT1Uwd1IzZFJhVTk1UVhGbGQxTlVXVXhuVjBKaFVXUXpjRVI0ZFZKbVVtWlRVVXhET0hCNU5FMVVOa28wWmxWcVp6WlNiSEJzZVUxT1luUnlaelJGYlVaVGQyeDZNMVpvVW1KSmVHdEhPRFJhWlhoa1duQjZXbmg0ZGxjclEzWjJia3BuYUVSc2NEQnZZbFJhYmxKWmJHaDRWSGhMU0dsdmJWZERTMFExV1RkTVIxZDNibVpvTUhSR1dIcDVSMlJCU0dOblpYSnNUeTlRVkdkNlRISm5SMkZTVm1aSWEwdHRTRFJJVG1sWVRHaE9UMkpvTXpGQ1UyTkVTM0Z3TmpoSGQySnpOR05qWkRjM1QzZE1iWE5rWVZKM1Z6aFhTazVMWlhNeUszbFhjVk4zYzNCdFZIRlVlR0ZDU25KMGRqVXlXbE4wYkZFMmIzZFhiRVZtYmtKcVYwVjFVamR0T1ZkaFpGVkZXWEJ1WkVGR2JVRlBhazUxWVVGUVNWZzFPVVZJVGpSV1VuQmpXRk5sZW5sQ2JuaFBUbVJEY1VWa1F6QkJWMFY1WldwUE4zVkVaak5HUWpWek1UQkViemRvYTBRemNqaENTbUZqUXpoV1QyTnlkRWR2VXpnM1JWUk5Wa3RXV2tSaWVsSmlUeXM0WlVOSVkyazVSelZFYzBKd2JsQkJaMDFDUVVGSGFtZGFkM2RuV210M1ExRlpSRlpTTUZSQ1FVbDNRVVJCVEVKblRsWklVVGhGUWtGTlEwSmxRWGRaUVZsRVZsSXdVa0pHYTNkV05FbFFaRE5rTTB4dFZqUlpWekYzWWtkVmRXSXpTbTV2UW10SFExZERSMU5CUjBjclZuTkZRbkZCVFVSQmIzaE5hazB3VGxSWk0wOUVhM3BvYVd4dlpFaFNkMk42YjNaTU1sWTBXVmN4ZDJKSFZYVmlNMHB1VERKYWIyRllTWFpVTTBwdVdWYzFjR1Z0UmpCaFZ6bDFUSHBGZVUxNlFXUkNaMDVXU0ZFMFJVWm5VVlZUY21NdldESnRPREJVVG5WcVNrUmhVRWh5TkU5bmIwMXpTMEYzUkZGWlNrdHZXa2xvZG1OT1FWRkZURUpSUVVSblowZENRVWhEV2pGRWJXRXhibXcyTXpNek5GcEhlV2dyY1RNeGFYWklkQzlMTkdoUFEyMVJPRXRwTUVkMVpVUmhZaTh5WTJ4c1RGUXlhRmxPVWxwR1RHUmlkRmRJZUdONmRVeFdhR2x5UlRKUlVTdFdkV05tYVhOUE5sazRWMHRZSzNwQlVVb3dZMlZIY2xWcE5EaHRjbGxsV0M5Q1NFaEhSVEpaUkhKb2VYTkdNVlpGUVZsQlFsRjFVbUpqTW5GMk4zaHhNazFIYURGblJtdERSVnBNYmpKSFVsbFNhR0ZKVmpnd1pFMHdMM1ZPTWt0eFQxVTBXa1ZOUkhSNWFFTTJablpRWWpWTlVWQXdSMVpQUTB0VlMzaGpNbXRuWW1kMlNVaENTazlhWms5UlFtNHliM1IyWTB4QmRDOWlURkV4Wm5SMlFUWTJVRmhoYTFJNGFGWktjRVphVVRSTVNuVTRXWFZPYlhNMldGbHRla1J1U1doUGVHaHRNbTg0Wmk5M01XbE5kVWh4U2pSblFVaExNakowWTNoSWVXSk5kblpwWTNaUFEwRmtVM0F2U0c1S05VdGhXVVYxTlhsM00yRm1ZMGhaVDFsNE1sVjJTSFJKTkRVdlduZDJaVU12Y0VsdlNIaDRNMkZLU2pCU04wZ3pRbEpKWVdSdE5UQjJXV2x2WlhOUFRIbGpNRGxuTTJwbU5URmlWRlI1TDFoaWJsa3pVV3hrWjI5TloyNWlPRmxtVlZNNFFVRnZTSFJrV1Znd2FuTlZRbmRvUlZGRmJqWk5Nek0xYTNCalMwdG9OMmMyUVhaWWJtZDBRV0pGVTFWUFJUTjNURXBYY1VWc2NYTndkRzluV1dSdFluQmtUME13YkZkUk1qTkNMMmRHY2pKc2MwSkJRVzgyVjA1S2FubHNVVDA5SWwxOS4uUmxBLVVZcUVXSmhmTmp0a1dNcDNVRUp4TlFGUWtQNm81V0ZLeWZiMFlPMk9RREJBUXpQYUNoUWZoMVAyY1c1NlFMeXlCcTNaNzFJXzVtSzlnekdGT29VT29JYWFsSGtkX1BoTDdfRkNqSUNvWWdTbWJPWmlTWGJJWFFGSDJCZW81b0xsc2RuV0JQa2x4c3NEeVRxZ1Q2bWw3UENzbTZad2h1ekdWcXhNcmtDODNLaTNhNlEyX09nSE9WWG5BV3RPNjNQd3F1OEIyOE4yWVUxaE9jTGs3QVhXbHFGSERtZnNZVGc1dnBrRUMyQ2VCZVNwbmxYZzR1TEtUa3lIS1h5R2xmUGxEVGY3Rk5LUFZlZW1HUTQ4UHk1S0F3dTJKekRCcnlMLUMxVDVxT05DZHZTWXBGQkZDWGFFRGNMSUx0MFNHcmI5UzlOQW41RWF4QS1BNHY4Y3RZNnpNVmJHR2tlelVFcnNhdGZEdllzVEFkeUpsLV83TFFlbUxhdnF3b0tiM1hEM2xKSUdOQWJMc0lvcFBCaTdHaDMxM0FndFRiekN1S2VxWUxOeWNNdDdhR2EzVnR3TzVybmw4SkdpRHlUejZzR1dfR0RyR0VDMURPbW4yRlBfRXV2VWVQT0pXRjhvLWJhVFIxcWt1a0hFOTliSGpYRXIyVXFpVGRpbFZZNjU=
