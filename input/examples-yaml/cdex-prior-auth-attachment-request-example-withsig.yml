# input/examples-yaml/cdex-prior-auth-attachment-request-example-withsig.yml

resourceType: Task
id: cdex-prior-auth-attachment-request-example-withsig
meta:
  extension:
    - url: http://hl7.org/fhir/StructureDefinition/instance-name
      valueString: Prior-Auth Attachment Request Example
    - url: http://hl7.org/fhir/StructureDefinition/instance-description
      valueMarkdown: '*Contained Claim Option*  Prior Authorization Attachment Request sent by payer to a provider requesting a signed History and physical (H&P) note.'
  profile:
    - "http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-task-attachment-request"
  tag:
    - system: "http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp"
      code: preauth-processing
contained:
  - resourceType: Patient
    id: patient
    meta:
      profile:
        - "http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-patient-demographics"
    # extension:
    #   - url: "http://hl7.org/fhir/us/core/StructureDefinition/us-core-birthsex"
    #     valueCode: F
    identifier:
      - use: usual
        type:
          coding:
            - system: "http://hl7.org/fhir/us/davinci-hrex/CodeSystem/hrex-temp" # vs http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBIdentifierType - um
              code: UMB
              display: Member Number
          text: Member Number
        system: "http://example.org/cdex/payer/member-ids"
        value: Member123
      - use: usual
        type:
          coding:
            - system: "http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBIdentifierType"
              code: pat
              display: Patient Account Number
          text: Patient Account Number
        system: "http://example.org/cdex/provider/patient-ids"
        value: PA-123
    name:
      - family: Shaw
        given:
          - Amy
    gender: female
    birthDate: "1987-02-20"
  - resourceType: Claim
    id: claim
    meta:
      profile:
        - "http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-claim"
    identifier:
      - type:
          coding:
            - system: "http://hl7.org/fhir/us/carin-bb/CodeSystem/C4BBIdentifierType"
              code: uc
              display: Unique Claim ID
          text: Unique Claim ID
        system: "http://example.org/cdex/payer/claim-ids"
        value: Preauth123
    status: active
    type:
      coding:
        - system: "http://terminology.hl7.org/CodeSystem/claim-type"
          code: institutional
          display: Institutional
      text: Institutional
    use: preauthorization
    patient:
      reference: "#patient"
    created: "2022-06-16T06:19:00+00:00"
    provider: # should be NPI supplied by Payer
      identifier:
        system: http://hl7.org/fhir/sid/us-npi
        value: "9941339108"
    priority:
      text: Normal
    supportingInfo:
      - sequence: 1
        category:
          coding:
            - system: http://hl7.org/fhir/us/davinci-pas/CodeSystem/PASSupportingInfoType
              code: patientEvent
        timingDate: "2022-06-13"
    insurance:
      - sequence: 1
        focal: true
        coverage:
          identifier: # ms 0..1 in data profile
            system: http://example.org/cdex/payer/member-ids
            value: "Member123"

identifier:
  - type:
      coding:
        - system: "http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp"
          code: tracking-id
          display: Tracking Id
      text: Re-Association Tracking Control Number
    system: "http://example.org/payer"
    value: trackingid123
status: requested
intent: order
code:
  coding:
    - system: "http://hl7.org/fhir/us/davinci-hrex/CodeSystem/hrex-temp"
      code: data-request
  text: Data Request
for:
  reference: "#patient"
  identifier: # ms 0..1 in data profile
    system: http://example.org/cdex/payer/member-ids
    value: "Member123"
authoredOn: "2022-06-17T16:16:06Z"
lastModified: "2022-06-17T16:16:06Z"
requester:
  identifier:
    system: http://example.org/cdex/payer/payer-ids
    value: "Payer123"
owner: # o..1 MS should be same as in claim is this needed?
  identifier:
    system: http://hl7.org/fhir/sid/us-npi #NPI
    value: "9941339108"
reasonReference:
  reference: "#claim"
  identifier: # ms 0..1 in data profile
    system: "http://example.org/cdex/payer/claim-ids" # could add FILL or PLAC types if that is important
    value: Preauth123
restriction:
  period:
    end: "2022-06-21"
input:
  - type:
      coding:
        - system: "http://hl7.org/fhir/us/davinci-hrex/CodeSystem/hrex-temp"
          code: data-code
    valueCodeableConcept:
      coding:
        - system: "http://loinc.org"
          code: 34117-2
          display: History and physical note
      text: History and Physical
    extension:
      - url: "http://hl7.org/fhir/us/davinci-pas/StructureDefinition/extension-serviceLineNumber"
        valuePositiveInt: 1
  # -
    # remove POU for now til we get it straighten
    # type:
    #     coding:
    #         -
    #             system: 'http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp'
    #             code: purpose-of-use
    # valueCodeableConcept:
    #     coding:
    #         -
    #             system: 'http://terminology.hl7.org/CodeSystem/v3-ActReason'
    #             code: CLMATTCH
  - type:
      coding:
        - system: "http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp"
          code: signature-flag
    valueBoolean: true
  - type:
      coding:
        - system: "http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp"
          code: payer-url
    valueUrl: "http://example.org/cdex/payer/$submit-attachment"
  # -
    # type:
    #     coding:
    #         -
    #             system: 'http://hl7.org/fhir/us/davinci-cdex/CodeSystem/cdex-temp'
    #             code: multiple-submits-flag
    # valueBoolean: false
