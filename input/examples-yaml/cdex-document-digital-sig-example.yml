
# steps to create/update dig signature examples
#
# 1. create unsigned Bundle or QuestionnaireResponse example source file with minified Narrative element(s) to prevent the publisher from adding its own.
# 1. for Documents Bundles use the autogenerated narrative instead to get it to verify. ( use only the -i parameter to keep the meta elements )
# 1. optionally create certificate using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Cert.ipynb
# 1. create signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Create_Digsign_Bundle_or_QR.ipynb
#  -  remove elements from payload as defined by the signature canonical and publisher requirements (for example, meta profile elements)
# 1. save to YAML source
# 1. run sushi and publisher again with -ink parameters
# 1. verify signatures using this script file: https://github.com/HL7/davinci-ecdx/blob/master/CDEX-Signatures/Verify_digsign_Bundle_or_QR.ipynb

resourceType: Bundle
identifier:
  system: urn:ietf:rfc:3986
  value: urn:uuid:c173535e-135e-48e3-ab64-38bacc68dba8
type: document
timestamp: '2021-10-25T20:16:29-07:00'
entry:
- fullUrl: urn:uuid:17a80a8d-4cf1-4deb-a1fd-2db1130e5f76
  resource:
    resourceType: Composition
    id: 17a80a8d-4cf1-4deb-a1fd-2db1130e5f76
    text:
      status: generated
      div: '<div xmlns="http://www.w3.org/1999/xhtml"><a name="Composition_17a80a8d-4cf1-4deb-a1fd-2db1130e5f76">
        </a><h3>Medical Records Document</h3><p>This document, titled "Active Conditions,"
        was created on October 25, 2021, by Dr. John Hancock, who also legally attested
        to its accuracy on the same date. It summarizes the active medical conditions
        for a patient based on an emergency encounter on October 25, 2021. The document
        includes one section detailing an active condition: Type 2 Diabetes Mellitus.</p></div>'
    status: final
    type:
      coding:
      - system: http://loinc.org
        code: 11503-0
      text: Medical records
    subject:
      reference: urn:uuid:970af6c9-5bbd-4067-b6c1-d9b2c823aece
      display: Example Patient
    encounter:
      reference: urn:uuid:5ce5c83a-000f-47d2-941c-039358cc9112
      display: Example Encounter
    date: '2021-10-25T20:16:29-07:00'
    author:
    - reference: urn:uuid:0820c16d-91de-4dfa-a3a6-f140a516a9bc
      display: Example Practitioner
    title: Active Conditions
    attester:
    - mode: legal
      time: '2021-10-25T20:16:29-07:00'
      party:
        reference: urn:uuid:0820c16d-91de-4dfa-a3a6-f140a516a9bc
        display: Example Practitioner
    section:
    - title: Active Condition 1
      entry:
      - reference: urn:uuid:014a68ec-d691-49e0-b980-91b0d924e570
- fullUrl: urn:uuid:0820c16d-91de-4dfa-a3a6-f140a516a9bc
  resource:
    resourceType: Practitioner
    id: 0820c16d-91de-4dfa-a3a6-f140a516a9bc
    meta:
      lastUpdated: '2013-05-05T16:13:03Z'
      profile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner|3.1.1
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner|6.1.0
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-practitioner|7.0.0
    text:
      status: generated
      div: <div xmlns="http://www.w3.org/1999/xhtml"><a name="Practitioner_0820c16d-91de-4dfa-a3a6-f140a516a9bc">
        </a><h3>Practitioner Information</h3><p>Dr. John Hancock is a healthcare provider
        with National Provider Identifier (NPI) 9941339100. He authored and attested
        to the medical records document.</p></div>
    identifier:
    - system: http://hl7.org/fhir/sid/us-npi
      value: '9941339100'
    name:
    - family: Hancock
      given:
      - John
- fullUrl: urn:uuid:970af6c9-5bbd-4067-b6c1-d9b2c823aece
  resource:
    resourceType: Patient
    id: 970af6c9-5bbd-4067-b6c1-d9b2c823aece
    meta:
      profile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient|3.1.1
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient|6.1.0
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-patient|7.0.0
    text:
      status: generated
      div: <div xmlns="http://www.w3.org/1999/xhtml"><a name="Patient_970af6c9-5bbd-4067-b6c1-d9b2c823aece">
        </a><h3>Patient Information</h3><p>CDEX Example Patient, a male, is identified
        by member ID Member123 in the payer system http://example.org/cdex/payer/member-ids.
        He is the subject of this medical records document. The patient said, "I feel
        great!"</p></div>
    identifier:
    - type:
        coding:
        - system: http://terminology.hl7.org/CodeSystem/v2-0203
          code: MB
      system: http://example.org/cdex/payer/member-ids
      value: Member123
    active: true
    name:
    - text: CDEX Example Patient
      family: Patient
      given:
      - CDEX Example
    gender: male
- fullUrl: urn:uuid:014a68ec-d691-49e0-b980-91b0d924e570
  resource:
    resourceType: Condition
    id: 014a68ec-d691-49e0-b980-91b0d924e570
    meta:
      profile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition|3.1.1
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition-problems-health-concerns|6.1.0
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-condition-problems-health-concerns|7.0.0
    text:
      status: generated
      div: "<div xmlns=\"http://www.w3.org/1999/xhtml\"><a name=\"Condition_014a68ec-d691-49e0-b980-91b0d924e570\"\
        > </a><h3>Active Condition</h3><p>The patient has an active diagnosis of Type\
        \ 2 Diabetes Mellitus (SNOMED CT: 44054006), first identified in 2006. This\
        \ condition was documented by Dr. John Hancock and is listed as a problem\
        \ on the patient\u2019s problem list.</p></div>"
    identifier:
    - system: urn:oid:1.3.6.1.4.1.22812.4.111.0.4.1.2.1
      value: '1'
    clinicalStatus:
      coding:
      - system: http://terminology.hl7.org/CodeSystem/condition-clinical
        code: active
    category:
    - coding:
      - system: http://terminology.hl7.org/CodeSystem/condition-category
        code: problem-list-item
        display: Problem List Item
      text: Problem List Item
    code:
      coding:
      - system: http://snomed.info/sct
        code: '44054006'
        display: Type 2 Diabetes Mellitus
    subject:
      reference: urn:uuid:970af6c9-5bbd-4067-b6c1-d9b2c823aece
    onsetDateTime: '2006'
    asserter:
      reference: urn:uuid:0820c16d-91de-4dfa-a3a6-f140a516a9bc
- fullUrl: urn:uuid:5ce5c83a-000f-47d2-941c-039358cc9112
  resource:
    resourceType: Encounter
    id: 5ce5c83a-000f-47d2-941c-039358cc9112
    meta:
      profile:
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter|3.1.1
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter|6.1.0
      - http://hl7.org/fhir/us/core/StructureDefinition/us-core-encounter|7.0.0
    text:
      status: generated
      div: '<div xmlns="http://www.w3.org/1999/xhtml"><a name="Encounter_5ce5c83a-000f-47d2-941c-039358cc9112">
        </a><h3>Encounter Details</h3><p>An emergency encounter occurred on October
        25, 2021, from 8:10 PM to 8:16 PM, involving CDEX Example Patient and attended
        by Dr. John Hancock at CDEX Example Organization. The encounter type is unspecified
        (SNOMED CT: 261665006).</p></div>'
    status: finished
    class:
      system: http://terminology.hl7.org/CodeSystem/v3-ActCode
      code: EMER
    type:
    - coding:
      - system: http://snomed.info/sct
        code: '261665006'
        display: Unknown (qualifier value)
      text: Unknown (qualifier value)
    subject:
      reference: urn:uuid:970af6c9-5bbd-4067-b6c1-d9b2c823aece
      display: CDEX Example Patient
    participant:
    - individual:
        reference: urn:uuid:0820c16d-91de-4dfa-a3a6-f140a516a9bc
        display: John Hancock
    period:
      start: '2021-10-25T20:10:29-07:00'
      end: '2021-10-25T20:16:29-07:00'
    serviceProvider:
      reference: urn:uuid:e37f004b-dc10-422b-b833-cdaa10a055a3
      display: CDEX Example Organization
- fullUrl: urn:uuid:e37f004b-dc10-422b-b833-cdaa10a055a3
  resource:
    resourceType: Organization
    id: e37f004b-dc10-422b-b833-cdaa10a055a3
    meta:
      profile:
      - http://hl7.org/fhir/us/davinci-hrex/StructureDefinition/hrex-organization
    text:
      status: generated
      div: '<div xmlns="http://www.w3.org/1999/xhtml"><a name="Organization_e37f004b-dc10-422b-b833-cdaa10a055a3">
        </a><h3>Organization Information</h3><p>CDEX Example Organization, located
        at 1 CDEX Lane, Boston, MA 01002, USA, is the service provider for the documented
        encounter. Contact details include phone: (+1) 555-555-5555 and email: customer-service@example.org.
        The organization''s NPI is 1234567893.</p></div>'
    identifier:
    - system: http://hl7.org/fhir/sid/us-npi
      value: '1234567893'
    active: true
    name: CDEX Example Organization
    telecom:
    - system: phone
      value: (+1) 555-555-5555
    - system: email
      value: customer-service@example.org
    address:
    - line:
      - 1 CDEX Lane
      city: Boston
      state: MA
      postalCode: '01002'
      country: USA
id: cdex-document-digital-sig-example
meta:
  profile:
  - http://hl7.org/fhir/us/davinci-cdex/StructureDefinition/cdex-signature-bundle
  extension:
  - url: http://hl7.org/fhir/StructureDefinition/instance-name
    valueString: CDEX Document with Digital Signature Example
  - url: http://hl7.org/fhir/StructureDefinition/instance-description
    valueMarkdown: Digital signature example showing how it is used to sign a FHIR
      Document.  The CDEX use case would be the target resource in response to a Task-based
      request where a digital signature was required.  If no signature was required,
      the response would typically be in the form of an individual resource.
signature:
  type:
  - system: urn:iso-astm:E1762-95:2013
    code: 1.2.840.10065.1.12.1.5
    display: Verification Signature
  when: '2020-10-23T04:54:56.048+00:00'
  who:
    identifier:
      system: http://hl7.org/fhir/sid/us-npi
      type:
        coding:
        - system: http://terminology.hl7.org/CodeSystem/v2-0203
          code: NPI
      value: '9941339100'
    display: John Hancock, MD
  onBehalfOf:
    identifier:
      system: http://hl7.org/fhir/sid/us-npi
      value: '1184932014'
  targetFormat: application/fhir+json;canonicalization=http://hl7.org/fhir/canonicalization/json#document
  sigFormat: application/jose
